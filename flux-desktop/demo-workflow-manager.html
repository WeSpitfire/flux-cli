<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flux Workflow Manager Demo</title>
  <link rel="stylesheet" href="src/renderer/workflow-ui.css">
  <link rel="stylesheet" href="src/renderer/workflow-manager.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #0a0a0a;
      color: #fff;
      padding: 40px;
      line-height: 1.6;
    }
    
    .demo-container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    h1 {
      font-size: 36px;
      margin-bottom: 12px;
      background: linear-gradient(135deg, #6366f1, #8b5cf6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .demo-subtitle {
      font-size: 18px;
      color: #888;
      margin-bottom: 40px;
    }
    
    .demo-section {
      background: #1e1e1e;
      border: 1px solid #3a3a3a;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
    }
    
    .demo-section h2 {
      font-size: 20px;
      margin-bottom: 16px;
      color: #fff;
    }
    
    .demo-section p {
      color: #aaa;
      margin-bottom: 16px;
      font-size: 14px;
    }
    
    .demo-buttons {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }
    
    .demo-btn {
      padding: 12px 24px;
      background: #2a2a2a;
      border: 1px solid #3a3a3a;
      border-radius: 8px;
      color: #fff;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .demo-btn:hover {
      background: #323232;
      border-color: #6366f1;
      transform: translateY(-2px);
    }
    
    .demo-btn-primary {
      background: #6366f1;
      border-color: #6366f1;
    }
    
    .demo-btn-primary:hover {
      background: #5558e3;
      border-color: #5558e3;
    }
    
    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 16px;
      margin-top: 16px;
    }
    
    .feature-card {
      background: #2a2a2a;
      padding: 20px;
      border-radius: 8px;
      border: 1px solid #3a3a3a;
    }
    
    .feature-icon {
      font-size: 32px;
      margin-bottom: 12px;
    }
    
    .feature-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #fff;
    }
    
    .feature-desc {
      font-size: 14px;
      color: #888;
      line-height: 1.5;
    }
    
    code {
      background: #2a2a2a;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 13px;
      color: #6366f1;
    }
  </style>
</head>
<body>
  <div class="demo-container">
    <h1>üìö Flux Workflow Manager</h1>
    <p class="demo-subtitle">Day 15: Complete Workflow Management System</p>
    
    <div class="demo-section">
      <h2>üéØ What's New</h2>
      <div class="feature-grid">
        <div class="feature-card">
          <div class="feature-icon">üìö</div>
          <div class="feature-title">Library Browser</div>
          <div class="feature-desc">Browse all workflows in a beautiful grid layout with search and filters</div>
        </div>
        <div class="feature-card">
          <div class="feature-icon">‚úèÔ∏è</div>
          <div class="feature-title">Visual Editor</div>
          <div class="feature-desc">Create and edit workflows with an intuitive drag-and-drop interface</div>
        </div>
        <div class="feature-card">
          <div class="feature-icon">üì§</div>
          <div class="feature-title">Import/Export</div>
          <div class="feature-desc">Share workflows as JSON files or import from others</div>
        </div>
        <div class="feature-card">
          <div class="feature-icon">üíæ</div>
          <div class="feature-title">Auto-Save</div>
          <div class="feature-desc">All workflows saved to localStorage automatically</div>
        </div>
      </div>
    </div>
    
    <div class="demo-section">
      <h2>üéÆ Try It Out</h2>
      <p>Click the buttons below to test the workflow manager:</p>
      <div class="demo-buttons">
        <button class="demo-btn demo-btn-primary" onclick="openManager()">
          üìö Open Workflow Library
        </button>
        <button class="demo-btn" onclick="createNewWorkflow()">
          ‚ûï Create New Workflow
        </button>
        <button class="demo-btn" onclick="openSelector()">
          üöÄ Run Workflow
        </button>
        <button class="demo-btn" onclick="exportAll()">
          üì§ Export All Workflows
        </button>
      </div>
    </div>
    
    <div class="demo-section">
      <h2>‚å®Ô∏è Keyboard Shortcuts</h2>
      <div class="demo-buttons">
        <div style="padding: 12px; background: #2a2a2a; border-radius: 8px; border: 1px solid #3a3a3a;">
          <code>Cmd/Ctrl + Shift + M</code> ‚Üí Open workflow manager
        </div>
        <div style="padding: 12px; background: #2a2a2a; border-radius: 8px; border: 1px solid #3a3a3a;">
          <code>Cmd/Ctrl + Shift + W</code> ‚Üí Open workflow selector
        </div>
        <div style="padding: 12px; background: #2a2a2a; border-radius: 8px; border: 1px solid #3a3a3a;">
          <code>Esc</code> ‚Üí Close dialogs
        </div>
      </div>
    </div>
    
    <div class="demo-section">
      <h2>‚ú® Features</h2>
      <ul style="color: #aaa; padding-left: 24px; line-height: 2;">
        <li><strong>Grid Layout:</strong> Beautiful card-based workflow library</li>
        <li><strong>Search:</strong> Filter workflows by name or description</li>
        <li><strong>Sort:</strong> By name, steps, or recent usage</li>
        <li><strong>Tag Filtering:</strong> Filter by workflow tags</li>
        <li><strong>Context Menu:</strong> Run, edit, duplicate, export, delete</li>
        <li><strong>Visual Editor:</strong> Step-by-step workflow builder</li>
        <li><strong>Step Types:</strong> Command, confirm, input, select, conditional, parallel</li>
        <li><strong>Import/Export:</strong> JSON-based workflow sharing</li>
        <li><strong>localStorage:</strong> Automatic persistence</li>
        <li><strong>Notifications:</strong> Toast messages for actions</li>
      </ul>
    </div>
    
    <div class="demo-section">
      <h2>üéØ Status: Day 15 Complete</h2>
      <p>‚úÖ Workflow library browser<br>
         ‚úÖ Grid layout with cards<br>
         ‚úÖ Search and filters<br>
         ‚úÖ Visual workflow editor<br>
         ‚úÖ Step-by-step builder<br>
         ‚úÖ Import/Export JSON<br>
         ‚úÖ localStorage persistence<br>
         ‚úÖ Context menus<br>
         ‚úÖ Notifications<br>
         ‚úÖ Keyboard shortcuts</p>
    </div>
  </div>
  
  <script src="src/renderer/workflow-engine.js"></script>
  <script src="src/renderer/workflow-ui.js"></script>
  <script src="src/renderer/workflow-manager.js"></script>
  
  <script>
    // Initialize workflow engine, UI, and manager
    const engine = new WorkflowEngine();
    const ui = new WorkflowUI(engine);
    const manager = new WorkflowManager(engine);
    
    // Load built-in workflows
    function loadWorkflows() {
      const workflows = [
        {
          name: "Git Commit & Push",
          description: "Add, commit, and push changes to remote repository",
          tags: ["git", "version-control"],
          author: "Flux Team",
          steps: [
            { type: "command", name: "Check git status", command: "git status --short" },
            { type: "command", name: "Stage all changes", command: "git add ." },
            { type: "input", name: "Get commit message", prompt: "Commit message:", variable: "message", required: true },
            { type: "command", name: "Commit changes", command: "git commit -m '{{message}}'" },
            { type: "confirm", name: "Push to remote?", message: "Push changes to origin?", default: true },
            { type: "command", name: "Push to remote", command: "git push origin main" },
            { type: "success", message: "‚úÖ Changes committed and pushed!" }
          ]
        },
        {
          name: "Deploy to Production",
          description: "Build, test, and deploy application to production environment",
          tags: ["deploy", "production", "ci/cd"],
          author: "Flux Team",
          variables: [
            { name: "environment", description: "Target environment", type: "select", options: ["staging", "production"], default: "production" }
          ],
          steps: [
            { type: "command", name: "Install dependencies", command: "npm install" },
            { type: "command", name: "Run tests", command: "npm test" },
            { type: "command", name: "Build application", command: "npm run build" },
            { type: "confirm", name: "Deploy confirmation", message: "Deploy to {{environment}}?", default: false },
            { type: "command", name: "Deploy", command: "npm run deploy:{{environment}}" },
            { type: "command", name: "Health check", command: "curl https://api.example.com/health" },
            { type: "success", message: "üéâ Deployed to {{environment}} successfully!" }
          ]
        },
        {
          name: "Docker Cleanup",
          description: "Remove unused Docker containers, images, and volumes",
          tags: ["docker", "cleanup", "maintenance"],
          author: "Flux Team",
          steps: [
            { type: "command", name: "Stop all containers", command: "docker stop $(docker ps -aq)" },
            { type: "command", name: "Remove containers", command: "docker rm $(docker ps -aq)" },
            { type: "command", name: "Remove unused images", command: "docker image prune -af" },
            { type: "confirm", name: "Remove volumes?", message: "Also remove volumes? (‚ö†Ô∏è  This deletes data)", default: false },
            { type: "command", name: "Show disk usage", command: "docker system df" },
            { type: "success", message: "‚úÖ Docker cleanup complete!" }
          ]
        },
        {
          name: "NPM Publish Package",
          description: "Build, test, version bump, and publish NPM package",
          tags: ["npm", "publish", "package"],
          author: "Flux Team",
          variables: [
            { name: "version", description: "Version bump type", type: "select", options: ["patch", "minor", "major"], default: "patch" }
          ],
          steps: [
            { type: "command", name: "Run tests", command: "npm test" },
            { type: "command", name: "Build package", command: "npm run build" },
            { type: "command", name: "Version bump", command: "npm version {{version}}" },
            { type: "command", name: "Generate changelog", command: "npm run changelog" },
            { type: "confirm", name: "Publish confirmation", message: "Publish to NPM registry?", default: false },
            { type: "command", name: "Publish package", command: "npm publish" },
            { type: "command", name: "Push git tags", command: "git push --follow-tags" },
            { type: "success", message: "üì¶ Package published successfully!" }
          ]
        },
        {
          name: "Database Migration",
          description: "Run database migrations with backup and rollback support",
          tags: ["database", "migration", "backup"],
          author: "Flux Team",
          variables: [
            { name: "direction", description: "Migration direction", type: "select", options: ["up", "down"], default: "up" }
          ],
          steps: [
            { type: "command", name: "Backup database", command: "pg_dump mydb > backup.sql" },
            { type: "confirm", name: "Run migration?", message: "Run migration {{direction}}?", default: true },
            { type: "command", name: "Run migration", command: "npm run migrate:{{direction}}" },
            { type: "command", name: "Verify migration", command: "npm run migrate:status" },
            { type: "success", message: "‚úÖ Migration complete!" }
          ]
        }
      ];
      
      // Register all workflows
      workflows.forEach(workflow => {
        engine.registerWorkflow(workflow);
      });
      
      // Load from localStorage (will override if exists)
      manager.loadFromLocalStorage();
      
      console.log('‚úÖ Loaded', engine.listWorkflows().length, 'workflows');
    }
    
    // Load workflows on page load
    loadWorkflows();
    
    // Listen for run-workflow events
    window.addEventListener('run-workflow', (e) => {
      ui.runWorkflow(e.detail.name);
    });
    
    // Demo functions
    function openManager() {
      manager.showManager();
    }
    
    function createNewWorkflow() {
      manager.showEditor(null);
    }
    
    function openSelector() {
      ui.showWorkflowSelector();
    }
    
    function exportAll() {
      const workflows = engine.listWorkflows();
      const json = JSON.stringify(workflows, null, 2);
      const blob = new Blob([json], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      
      const a = document.createElement('a');
      a.href = url;
      a.download = 'flux-workflows.json';
      a.click();
      
      URL.revokeObjectURL(url);
      manager.showNotification(`üì§ Exported ${workflows.length} workflows`);
    }
    
    console.log('üöÄ Flux Workflow Manager Demo Ready!');
    console.log('Press Cmd/Ctrl+Shift+M to open workflow manager');
    console.log('Press Cmd/Ctrl+Shift+W to open workflow selector');
  </script>
</body>
</html>
