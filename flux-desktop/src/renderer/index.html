<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval';">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flux - AI Coding Assistant</title>
    <link rel="stylesheet" href="xterm.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="command-palette.css">
    <link rel="stylesheet" href="command-confirm-dialog.css">
  </head>
  <body>
    <div class="app-container">
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <div class="logo">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M13 2L3 14h8l-1 8 10-12h-8l1-8z" fill="currentColor"/>
            </svg>
            <span class="logo-text">Flux</span>
          </div>
        </div>
        <div class="header-center">
          <div class="status-indicator">
            <div class="status-dot" id="status-dot"></div>
            <span id="status-text">Ready</span>
          </div>
        </div>
        <div class="header-right">
          <button class="icon-btn" id="clear-btn" title="Clear terminal">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M2 14h12M8 2v8m-4-4l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
          </button>
          <button class="icon-btn" id="settings-btn" title="Settings">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <circle cx="8" cy="8" r="3" stroke="currentColor" stroke-width="1.5"/>
              <path d="M8 1v2m0 10v2M1 8h2m10 0h2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
          </button>
        </div>
      </header>

      <!-- Main content area -->
      <main class="main-content">
        <!-- Sidebar for history and context -->
        <aside class="sidebar" id="sidebar">
          <!-- Tabs -->
          <div class="sidebar-tabs">
            <button class="sidebar-tab active" data-tab="history">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                <path d="M8 2v6l4 2M14 8A6 6 0 112 8a6 6 0 0112 0z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
              </svg>
              History
            </button>
            <button class="sidebar-tab" data-tab="files">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                <path d="M2 2h5l2 2h5v9H2V2z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
              </svg>
              Files
            </button>
          </div>

          <!-- History Panel -->
          <div class="sidebar-panel active" id="history-panel">
            <div class="sidebar-header">
              <h3>Recent Commands</h3>
              <button class="icon-btn" id="toggle-sidebar">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                  <path d="M10 4L6 8l4 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
              </button>
            </div>
            <div class="history-list" id="history-list">
              <!-- History items will be populated here -->
            </div>
          </div>

          <!-- File Explorer Panel -->
          <div class="sidebar-panel" id="files-panel">
            <div class="sidebar-header">
              <h3>File Explorer</h3>
              <button class="icon-btn" id="change-directory" title="Change Directory">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                  <path d="M2 2h5l2 2h5v9H2V2z" stroke="currentColor" stroke-width="1.5"/>
                  <path d="M6 9l2-2 2 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
              </button>
            </div>
            <div class="current-directory" id="current-directory">
              <div class="directory-path" id="directory-path">Loading...</div>
            </div>
            <div class="file-tree" id="file-tree-container">
              <!-- File tree will be populated here -->
            </div>
          </div>
        </aside>

        <!-- Terminal and input area -->
        <div class="workspace">
          <div class="terminal-wrapper">
            <div id="terminal"></div>
          </div>
          
          <div class="input-area">
            <div class="input-wrapper">
              <div class="input-prefix">$</div>
              <textarea 
                id="command-input" 
                placeholder="Ask Flux anything or type a command..."
                autocomplete="off"
                spellcheck="false"
                rows="1"
                style="resize: none; overflow: hidden;"
              ></textarea>
              <button class="send-btn" id="send-btn" title="Send (Enter)">
                <svg class="send-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                  <path d="M2 10l16-8-8 16-2-6-6-2z" fill="currentColor"/>
                </svg>
                <svg class="stop-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" style="display: none;">
                  <rect x="5" y="5" width="10" height="10" rx="1" fill="currentColor"/>
                </svg>
              </button>
            </div>
            <div class="input-hint">
              <kbd>Enter</kbd> send • <kbd>Cmd+K</kbd> command palette • <kbd>Ctrl+C</kbd> / <kbd>Esc</kbd> skip • <kbd>↑/↓</kbd> history
            </div>
          </div>
        </div>
      </main>
    </div>

    <script src="command-intelligence.js"></script>
    <script src="command-confirm-dialog.js"></script>
    <script src="command-palette.js"></script>
    <script src="renderer.js"></script>
    <script src="file-explorer.js"></script>
  </body>
</html>
